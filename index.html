<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>NoFap Takip 2.0</title>
<style>
:root{
  --bg:#ffffffcc;--text:#1c1b1f;--primary:#00695c;--clean:#4caf50;
  --dirty:#f44336;--surface:#e0f2f1;--disable:#9e9e9e;
}
[data-theme='dark']{
  --bg:#121212cc;--text:#e6e1e5;--primary:#4db6ac;--clean:#66bb6a;
  --dirty:#ef5350;--surface:#1e1e1e80;
}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',system-ui}
body{min-height:100vh;display:flex;align-items:center;justify-content:center;
     background:linear-gradient(135deg,#4db6ac 0%,#00897b 100%);color:var(--text);transition:background .4s;}
.glass{background:var(--surface);border-radius:24px;padding:32px 40px;text-align:center;
       box-shadow:0 8px 30px rgba(0,0,0,.15);animation:fadeIn 1s}
@keyframes fadeIn{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}
.miniCard{max-width:320px;width:90%;animation:slideUp 1s}
@keyframes slideUp{from{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}
.big14{font-size:96px;font-weight:700;color:var(--primary);line-height:1}
.subtitle{font-size:22px;margin-top:4px}
.quote{font-size:16px;margin:8px 0 20px;opacity:.8;font-style:italic}
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:4px;margin:16px auto 0;max-width:280px;animation:zoomIn 1s}
@keyframes zoomIn{from{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}

.day:hover{transform:scale(1.1)}
.legend{font-size:12px;margin-top:8px}
.btnGroup button{padding:8px 18px;border:none;border-radius:50px;background:var(--primary);color:#fff;font-weight:600;cursor:pointer;margin:6px;transition:background .3s}
.btnGroup button:hover{background:#004d40}
.btnGroup button:disabled{background:var(--disable);cursor:not-allowed}
.theme-toggle{position:absolute;top:20px;right:20px;font-size:16px;cursor:pointer;display:flex;align-items:center;gap:6px;background:var(--surface);padding:6px 12px;border-radius:50px;box-shadow:0 2px 8px rgba(0,0,0,.1)}
.modal{display:none;position:fixed;inset:0;background:#00000080;backdrop-filter:blur(6px);align-items:center;justify-content:center;z-index:999;animation:fadeIn .3s}
.modal .glass{max-width:340px;width:90%}
input,textarea{width:100%;padding:8px;border-radius:12px;border:1px solid #ffffff50;background:#ffffff30;color:var(--text)}
.historyList{max-height:200px;overflow-y:auto;margin-top:12px;text-align:left;font-size:14px}

select {
  background-color: var(--surface);
  color: var(--text);
  border: 1px solid #999;
  padding: 6px 10px;
  border-radius: 10px;
  font-weight: 600;
  margin: 8px 4px;
  appearance: none;
  box-shadow: 0 1px 3px #00000030;
}

select:focus {
  outline: none;
  border-color: var(--primary);
}

button {
  padding: 8px 18px;
  border: none;
  border-radius: 50px;
  background: var(--primary);
  color: #fff;
  font-weight: 600;
  cursor: pointer;
  margin: 6px;
  transition: background 0.3s, transform 0.2s;
}

button:hover {
  background: #004d40;
  transform: scale(1.05);
}

button:disabled {
  background: var(--disable);
  cursor: not-allowed;
}

.day {
  aspect-ratio: 1;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  transition: transform 0.3s, background 0.3s;
  border: 2px solid var(--text);
  color: var(--text);
  background: transparent;
}

.day.clean {
  background: var(--clean);
  color: #fff;
  border-color: var(--clean);
}

.day.dirty {
  background: var(--dirty);
  color: #fff;
  border-color: var(--dirty);
}

.day.today {
  outline: 2px solid var(--primary);
  box-shadow: 0 0 6px var(--primary);
}

.greeting {
  font-size: 18px;
  margin-bottom: 8px;
  color: var(--primary);
  font-weight: 600;
}

.header {
  position: absolute;
  top: 20px;
  left: 20px;
  font-size: 24px;
  font-weight: 700;
  background: linear-gradient(90deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  animation: rainbow 8s linear infinite;
  background-size: 400% 100%;
  cursor: pointer;
  user-select: none;
}

@keyframes rainbow {
  0% { background-position: 0% 50% }
  50% { background-position: 100% 50% }
  100% { background-position: 0% 50% }
}

</style>
</head>
<body>

<div class="header" id="secretReset">NoFap Takip 2.0</div>
<div class="theme-toggle" id="themeToggle">
  <span id="themeText">Koyu Moda GeÃ§</span>
  <span id="themeIcon">ðŸŒ™</span>
</div>

<!-- 1) Ä°lk ekran -->
<div class="glass miniCard" id="setupCard">
  <h3>HoÅŸ geldin</h3>
  <label>Ä°sim</label>
  <input id="nameInput" placeholder="AdÄ±n"/>
  <label>Ä°lk temiz gÃ¼n</label>
  <input id="startDateInput" type="date"/>
  <button onclick="saveSetup()">Kaydet</button>
</div>

<!-- 2) Ana ekran -->
<div class="glass" id="mainCard" style="display:none">
  <div class="greeting" id="greeting">Merhaba, Dostum</div>
  <div class="big14" id="streak">0</div>
  <div class="subtitle">gÃ¼ndÃ¼r mastÃ¼rbasyon yapmÄ±yorsun</div>
  <div class="quote" id="quote"></div>

  <!-- Takvim -->
  <select id="monthSel" onchange="renderCal()"></select>
  <select id="yearSel" onchange="renderCal()"></select>
  <div class="calendar" id="calendar"></div>
  <div class="legend">YeÅŸil = temizâ€ƒâ€ƒKÄ±rmÄ±zÄ± = relapse</div>

  <div class="btnGroup">
    <button onclick="openResetModal()">Relapse</button>
    <button onclick="openHistory()">GeÃ§miÅŸ</button>
    <button onclick="openAbout()">HakkÄ±nda</button>
  </div>
</div>

<!-- 3) Modallar -->
<!-- Reset / Neden -->
<div class="modal" id="resetModal">
  <div class="glass">
    <h3>Neden relapse oldun?</h3>
    <textarea id="resetReason" placeholder="Neden pes ettin?" rows="4"></textarea>
    <button id="resetBtn" onclick="resetAll()">Tamam</button>
    <button onclick="closeResetModal()">Ä°ptal</button>
  </div>
</div>

<!-- GeÃ§miÅŸ -->
<div class="modal" id="historyModal">
  <div class="glass">
    <h3>GeÃ§miÅŸ Streakler</h3>
    <div class="historyList" id="historyList"></div>
    <button onclick="closeHistory()">Kapat</button>
  </div>
</div>

<!-- HakkÄ±nda -->
<div class="modal" id="aboutModal">
  <div class="glass">
    <h3>HakkÄ±nda</h3>
    <p><strong>YapÄ±mcÄ±:</strong> Resul Ã‡elik</p>
    <a href="https://github.com/anotherphonker" target="_blank" style="color:var(--primary);text-decoration:none;font-weight:600">GitHub Profili</a>
    <br><br>
    <button onclick="closeAbout()">Kapat</button>
  </div>
</div>

<script>
const today=new Date(),todayStr=today.toISOString().split('T')[0];
let clickCount = 0;
let lastClickTime = 0;

/* tema */
function updateThemeButton() {
  const dark = document.documentElement.getAttribute('data-theme') === 'dark';
  document.getElementById('themeText').textContent = dark ? 'AÃ§Ä±k Moda GeÃ§' : 'Koyu Moda GeÃ§';
  document.getElementById('themeIcon').textContent = dark ? 'â˜€ï¸' : 'ðŸŒ™';
}

document.getElementById('themeToggle').onclick=()=>{
  const dark=document.documentElement.getAttribute('data-theme')==='dark';
  document.documentElement.setAttribute('data-theme',dark?'light':'dark');
  localStorage.setItem('theme',dark?'light':'dark');
  updateThemeButton();
};

// BaÅŸlangÄ±Ã§ta tema butonunu gÃ¼ncelle
(()=>{
  const savedTheme = localStorage.getItem('theme') || 'light';
  document.documentElement.setAttribute('data-theme', savedTheme);
  updateThemeButton();
})();

const get=k=>localStorage.getItem(k)||'';
const set=(k,v)=>localStorage.setItem(k,v);
let name=get('name')||'';
let startDate=get('startDate')||todayStr;
let history=JSON.parse(localStorage.getItem('history')||'[]');

const quotes=[
  "Zafer, zafer benimdir diyebilenindir. BaÅŸarÄ± ise â€œbaÅŸaracaÄŸÄ±mâ€ diye baÅŸlayarak sonunda â€œbaÅŸardÄ±m diyenindir. (Mustafa Kemal AtatÃ¼rk)",
"Kazanma isteÄŸi ve baÅŸarÄ±ya ulaÅŸma arzusu birleÅŸirse kiÅŸisel mÃ¼kemmelliÄŸin kapÄ±sÄ±nÄ± aÃ§ar. (KonfÃ¼Ã§yÃ¼s)",
"HiÃ§bir ÅŸeyden vazgeÃ§me, Ã§Ã¼nkÃ¼ sadece kaybedenler vazgeÃ§er. (Abraham Lincoln)",
"BaÅŸarÄ±ya Ã§Ä±kan asansÃ¶r bozuk. Bekleyerek zaman kaybetmeyin, adÄ±m adÄ±m merdivenleri Ã§Ä±kmaya baÅŸlayÄ±n. (Joe Girard)",
"FÄ±rsatlar durup dururken karÅŸÄ±nÄ±za Ã§Ä±kmaz, onlarÄ± siz yaratÄ±rsÄ±nÄ±z. (Chris Grosser)",
"Åžansa Ã§ok inanÄ±rÄ±m ve ne kadar Ã§ok Ã§alÄ±ÅŸtÄ±ysam ona o kadar Ã§ok sahip oldum. (Thomas Jefferson)",
"Bir ÅŸeye baÅŸlayÄ±p baÅŸarÄ±sÄ±z olmaktan daha kÃ¶tÃ¼ tek ÅŸey hiÃ§bir ÅŸeye baÅŸlamamaktÄ±r. (Seth Godin)",
"Sadece sÄ±nÄ±rlarÄ±nÄ± aÅŸmanÄ±n riskini alanlar ne kadar ileri gidebildiklerini gÃ¶rÃ¼rler. (T.S. Elliot)",
"Hayat her ne kadar zor gÃ¶rÃ¼nse de, yapabileceÄŸimiz ve baÅŸarabileceÄŸimiz bir ÅŸey mutlaka vardÄ±r. (Stephen Hawking)",
"Bir ÅŸeyi baÅŸarmak ne kadar zorsa, zaferin tadÄ± o kadar gÃ¼zeldir. (Pele)",
"Bir ÅŸeye baÅŸlayÄ±p baÅŸarÄ±sÄ±z olmaktan daha kÃ¶tÃ¼ tek ÅŸey hiÃ§bir ÅŸeye baÅŸlamamaktÄ±r. (Seth Godin)",
"HiÃ§ kimse baÅŸarÄ± merdivenine elleri cebinde tÄ±rmanmamÄ±ÅŸtÄ±r. (J. Keth Moorhead)",
"Ne zaman baÅŸarÄ±lÄ± bir iÅŸ gÃ¶rseniz, birisi bir zamanlar mutlaka cesur bir karar almÄ±ÅŸtÄ±r. (Peter Ducker)",
"Sessizce sÄ±kÄ± Ã§alÄ±ÅŸÄ±n, bÄ±rakÄ±n baÅŸarÄ± sesiniz olsun. (Frank Ocean)",
"EÄŸer her ÅŸey kontrol altÄ±nda gibi gÃ¶rÃ¼nÃ¼yorsa, yeterince hÄ±zlÄ± gitmiyorsunuzdur. (Mario Andretti)",
"BaÅŸarÄ±sÄ±z insanlar iÃ§erisinde bulunduklarÄ± duruma gÃ¶re karar verirler. BaÅŸarÄ±lÄ± insanlar ise olmak istedikleri yere gÃ¶re karar verirler. (Benjamin Hardy)",
"Sadece baÅŸarÄ±lÄ± bir insan olmaya deÄŸil, deÄŸerli bir insan olmaya Ã§alÄ±ÅŸÄ±n. (Albert Einstein)",
"BaÅŸarÄ± son deÄŸildir, baÅŸarÄ±sÄ±zlÄ±k ise Ã¶lÃ¼mcÃ¼l deÄŸildir: Ã–nemli olan ilerlemeye cesaret etmektir. (Winston S. Churchill)",
"HayatÄ±mÄ± sadece ben deÄŸiÅŸtirebilirim. Kimse benim iÃ§in bunu yapmaz. (Carol Burnett)",
"HiÃ§ kimse geriye gidip yeni bir baÅŸlangÄ±Ã§ yapamaz ama bugÃ¼n yeni bir son yapÄ±p yeniden baÅŸlayabilir. (Frank M. Robinson)",
"DiÄŸerlerinden daha akÄ±llÄ± olmak zorunda deÄŸiliz. DiÄŸerlerinden daha disiplinli olmak zorundayÄ±z. (Warren Buffett)",
"UyandÄ±ÄŸÄ±nÄ±zda; yaÅŸamanÄ±n, zevk almanÄ±n, dÃ¼ÅŸÃ¼nmenin ve sevmenin ne kadar bÃ¼yÃ¼k bir ayrÄ±calÄ±k olduÄŸunu hatÄ±rlayÄ±n. (Marcus Aurelius)",
"Siz kendinize inanÄ±n, baÅŸkalarÄ± da size inanacaktÄ±r. (Goethe)",
"KaranlÄ±ktan korkan bir Ã§ocuÄŸu kolayca affedebiliriz. HayatÄ±n gerÃ§ek trajedisi bÃ¼yÃ¼kler Ä±ÅŸÄ±ktan korktuÄŸunda baÅŸlar. (Plato)",
"DÃ¼nyayÄ± deÄŸiÅŸtirebilen insanla buna inanacak kadar deli olanlardÄ±r. (Steve Jobs)",
"Sadece gÃ¶rÃ¼lmeyeni gÃ¶ren imkansÄ±zÄ± baÅŸarabilir. (Frank L. Gaines)",
"Her gÃ¼n kendini yeniliyorsun. Bazen baÅŸarÄ±lÄ± olursun, bazen olamazsÄ±n, ama Ã¶nemli olan ortalamadÄ±r. (Satya Nadella)",
"KÄ±sa vadede acÄ±masÄ±zca dÃ¼rÃ¼st olun, uzun vade iÃ§in ise iyimser ve kendinizden emin olun. (Reed Hastings)",
"Birisi size bir ÅŸeyi yapamayacaÄŸÄ±nÄ± sÃ¶ylediÄŸinde, belki de size sadece kendi yapamadÄ±klarÄ±nÄ± sÃ¶ylÃ¼yordur. (Sheldon Cahoon)",
"Kendinizi sÄ±nÄ±rlamayÄ±n. Ã‡oÄŸu insan yapabileceklerini dÃ¼ÅŸÃ¼ndÃ¼kleri ÅŸeyler konusunda kendilerini sÄ±nÄ±rlarlar. Sadece zihninizin gidebildiÄŸi kadar ileriye gidebilirsiniz. Neye inanÄ±rsanÄ±z, onu yapabilirsiniz. (Mary Kay Ash)",
"Zeki insanlar herkesten ve her ÅŸeyden Ã¶ÄŸrenirler. Ortalama insanlar deneyimlerinden Ã¶ÄŸrenirler. Aptal insanlar ise zaten bÃ¼tÃ¼n cevaplara sahiptir. (Socrates)",
"BardaÄŸÄ±n yarÄ±sÄ±nÄ±n dolu mu, boÅŸ mu olduÄŸunu tartÄ±ÅŸan insanlar asÄ±l odaklanmalarÄ± gereken noktayÄ± kaÃ§Ä±rÄ±yorlar. Bardak doldurulabilir. (Anonim)",
"YÃ¼zÃ¼nÃ¼zÃ¼ gÃ¼neÅŸe Ã§evirin, bÃ¶ylece gÃ¶lgeler her zaman arkanÄ±zda kalacaktÄ±r. (Walt Whitman)",
"DÃ¼n zekiydim, bu yÃ¼zden dÃ¼nyayÄ± deÄŸiÅŸtirmek istedim. Åžimdi ise bilgeyim, bu sebeple kendimi deÄŸiÅŸtiriyorum. (Rumi)",
"EÄŸer bir ÅŸeyi deÄŸiÅŸtiremiyorsanÄ±z bÄ±rakÄ±n. DeÄŸiÅŸtiremediÄŸiniz ÅŸeylerin mahkÃ»mu olmayÄ±n. (Tsang Lindsay)",
"DÄ±ÅŸarÄ±da olanlarÄ± her zaman kontrol edemezsiniz. Ama iÃ§inde olanlarÄ± edebilirsin. (Wayne Dyer)",
"En bÃ¼yÃ¼k dÃ¼ÅŸmanÄ±nÄ±zÄ±n iki kulaÄŸÄ±nÄ±zÄ±n arasÄ±nda yaÅŸamadÄ±ÄŸÄ±na emin olun. (Laird Hamilton)",
"DÃ¼nden ders alÄ±n, bugÃ¼n iÃ§in yaÅŸayÄ±n, yarÄ±n iÃ§in umutlu olun. (Albert Einstein)",
"BugÃ¼n iÃ§inde bulunduÄŸunuz mÃ¼cadele, yarÄ±n ihtiyacÄ±nÄ±z olan gÃ¼cÃ¼ geliÅŸtiriyor. (Robert Tew)",
"Hayat her ne kadar zor gÃ¶rÃ¼nse de, yapabileceÄŸiniz ve baÅŸarabileceÄŸiniz bir ÅŸey her zaman vardÄ±r. (Stephen Hawking)",
"Ã‡atÄ±ÅŸman ne kadar zorsa, zaferin de o kadar ÅŸereflidir! (Thomas Paine)",
"YÃ¼zÃ¼stÃ¼ yere serilseniz bile, hala ileriye doÄŸru hareket ediyorsunuzdur! (Victor Kiam)",
"TanrÄ±dan kolay bir hayat dilemeyin: zor olana dayanabilecek gÃ¼Ã§ dileyin. (Bruce Lee)",
"Bir gÃ¼n geÃ§miÅŸe baktÄ±ÄŸÄ±nÄ±zda en gÃ¼zel yÄ±llarÄ±nÄ±zÄ±n mÃ¼cadele ile geÃ§en yÄ±llar olduÄŸunu gÃ¶receksiniz. (Sigmund Freud)",
"Girmeye korktuÄŸun maÄŸara, umduÄŸun hazineyi saklÄ±yor olabilir. (Joseph Campbell)",
"MaÄŸlubiyete uÄŸrayÄ±nca Ã¼mitsizliÄŸe kapÄ±lma, her baÅŸarÄ±sÄ±zlÄ±kta bir zafer arzusu yatar. (Germain Martin)",
"YÃ¼zleÅŸmediÄŸimiz korkularÄ±mÄ±z sÄ±nÄ±rlarÄ±mÄ±zÄ± oluÅŸturur. (Amy Elizabeth)",
"Zorluklarla karÅŸÄ±laÅŸmak istemeyenler, felaketlere layÄ±ktÄ±r. (Lucius Annaeus Seneca)",
"DÃ¼nya herkesi kÄ±rar ve bazÄ±larÄ± kÄ±rÄ±lan yerlerinden gÃ¼Ã§lenir. (Ernest Hemingway)",
"AcÄ± sizi deÄŸiÅŸtirebilir ancak bu deÄŸiÅŸim kÃ¶tÃ¼ olmak zorunda deÄŸildir. AcÄ±yÄ± alÄ±n ve bilgeliÄŸe dÃ¶nÃ¼ÅŸtÃ¼rÃ¼n. (Dalai Lama)",
"EÄŸer insanlar ne kadar ileri gidebileceÄŸinizi sorguluyorsa, onlarÄ± duyamayacaÄŸÄ±nÄ±z kadar ileriye gidin. (Michele Ruiz)",
"Ä°nsanlarÄ± gÃ¼Ã§lendiren ÅŸey, zor gÃ¼nlerdir. (Aly Raisman)",
"ZorluklarÄ±nÄ±zÄ± sÄ±nÄ±rlamayÄ±n. SÄ±nÄ±rlarÄ±nÄ±zÄ± zorlayÄ±n. (Anonim)",
"Yenilmek geÃ§ici bir durumdur. Pes etmek ise onu kalÄ±cÄ± yapar. (Marilyn Vos Savant)",
"Bazen karanlÄ±k bir yerdeyken gÃ¶mÃ¼ldÃ¼ÄŸÃ¼nÃ¼zÃ¼ dÃ¼ÅŸÃ¼nÃ¼rsÃ¼nÃ¼z. Ama aslÄ±nda ekilmiÅŸsinizdir. (Christine Caine)",
"Vaktinde bana â€œhayÄ±râ€ diyen herkese minnettarÄ±m. Onlar sayesinde kendi iÅŸimi kendim yapabiliyorum. (Wayne W. Dyer)",
"Pes etmeyi dÃ¼ÅŸÃ¼ndÃ¼ÄŸÃ¼nÃ¼zde, hala haksÄ±z Ã§Ä±karmanÄ±z gereken insanlar olduÄŸunu hatÄ±rlayÄ±n. (Anonim)"
];

// Gizli reset mekanizmasÄ±
document.getElementById('secretReset').addEventListener('click', () => {
  const now = Date.now();
  if (now - lastClickTime > 1000) { // 1 saniyeden fazla geÃ§miÅŸse sÄ±fÄ±rla
    clickCount = 0;
  }
  clickCount++;
  lastClickTime = now;
  
  if (clickCount >= 5) {
    localStorage.clear();
    document.getElementById('mainCard').style.display='none';
    document.getElementById('setupCard').style.display='block';
    document.getElementById('nameInput').value='';
    document.getElementById('startDateInput').value=todayStr;
    name = '';
    startDate = todayStr;
    history = [];
    clickCount = 0;
    alert("Sistem sÄ±fÄ±rlandÄ± gardaÅŸ! Yeniden baÅŸlÄ±yoruz ðŸ’ª");
  }
});

function saveSetup(){
  name=document.getElementById('nameInput').value.trim()||'Dostum';
  startDate=document.getElementById('startDateInput').value||todayStr;
  set('name',name);set('startDate',startDate);
  initApp();
}
function initApp(){
  document.getElementById('setupCard').style.display='none';
  document.getElementById('mainCard').style.display='block';
  document.getElementById('greeting').textContent = `Merhaba, ${name}`;
  fillSelects();renderCal();randomQuote();
}
function streakDays(){
  return Math.floor((today-new Date(startDate))/864e5);
}
function randomQuote(){
  document.getElementById('quote').textContent=quotes[Math.floor(Math.random()*quotes.length)];
}
function fillSelects(){
  const mSel=document.getElementById('monthSel'),ySel=document.getElementById('yearSel');
  mSel.innerHTML='';
  ['Ocak','Åžubat','Mart','Nisan','MayÄ±s','Haziran','Temmuz','AÄŸustos','EylÃ¼l','Ekim','KasÄ±m','AralÄ±k']
    .forEach((m,i)=>mSel.add(new Option(m,i)));
  ySel.innerHTML='';
  for(let y=2020;y<=today.getFullYear()+1;y++)ySel.add(new Option(y,y));
  mSel.value=today.getMonth();
  ySel.value=today.getFullYear();
}
function renderCal(){
  const days=streakDays();
  document.getElementById('streak').textContent=Math.max(0,days);
  const y=+document.getElementById('yearSel').value;
  const m=+document.getElementById('monthSel').value;
  const first=new Date(y,m,1).getDay();
  const dim=new Date(y,m+1,0).getDate();
  const cal=document.getElementById('calendar');
  cal.innerHTML='';

  // boÅŸ hÃ¼creler
  for(let i=0;i<first;i++) cal.appendChild(document.createElement('div'));

  for(let d=1;d<=dim;d++){
    const cell=document.createElement('div');
    cell.className='day';
    const curDate=new Date(y,m,d);
    const dateStr=curDate.toISOString().split('T')[0];

    if(dateStr===todayStr) cell.classList.add('today');

    if(curDate<new Date(startDate)){
      // baÅŸlamadan Ã¶nce
    }else if(curDate>today){
      // gelecek
    }else{
      const relapse=history.some(h=>h.endDate===dateStr);
      cell.classList.add(relapse?'dirty':'clean');
    }
    cell.textContent=d;
    cal.appendChild(cell);
  }
}
function openResetModal(){
  document.getElementById('resetModal').style.display='flex';
  document.getElementById('resetReason').value='';
  toggleResetBtn();
}
function closeResetModal(){document.getElementById('resetModal').style.display='none';}
function toggleResetBtn(){
  const reason=document.getElementById('resetReason').value.trim();
  const btn=document.getElementById('resetBtn');
  btn.disabled=!reason;
}
document.getElementById('resetReason').addEventListener('input',toggleResetBtn);

function openHistory(){
  const list=document.getElementById('historyList');
  list.innerHTML='';
  if(!history.length) list.innerHTML='<p>HenÃ¼z kayÄ±t yok.</p>';
  else history.forEach(h=>list.insertAdjacentHTML('beforeend',
    `<p><strong>${h.streak} gÃ¼n</strong> â€“ bitiÅŸ: ${h.endDate}<br>neden: ${h.reason}</p>`));
  document.getElementById('historyModal').style.display='flex';
}
function closeHistory(){document.getElementById('historyModal').style.display='none';}
function openAbout(){document.getElementById('aboutModal').style.display='flex';}
function closeAbout(){document.getElementById('aboutModal').style.display='none';}

function resetAll(){
  const reason=document.getElementById('resetReason').value.trim();
  if(!reason) return;
  history.unshift({streak:streakDays(),endDate:todayStr,reason});
  localStorage.setItem('history',JSON.stringify(history));
  localStorage.setItem('startDate',todayStr);
  renderCal();
  closeResetModal();
}
if(name && startDate) initApp();
else document.getElementById('startDateInput').value=todayStr;
</script>
</body>
</html>